\KwIn{
  $workerSet=\{w_1, w_2, \ldots, w_m\}$,
  $jobSet=\{j_1, j_2, \ldots, j_n\}$,
  preserving rate $r\in[0,1]$
}
\KwOut{A mapping of each job to scheduled workers}
$result \gets$
KeyValueMap(key $\to \{\}$ for all key $\in jobSet$)\;
$jobSet \gets$ $sortByPriority(jobSet)$\;
$c \gets$ $min(jobSet[0]$.totalTask, $workerSet$.size$-floor((1-r) *
workerSet.$size$)$\;
$result[jobSet[0]] \gets$ $\{w_1, ..., w_c\}$\;
\For{$i=1$ to $min(m-c, n)$}{
  $result[jobSet[i]]$ $\gets$ $\{w_{c+i}\}$\;
}
\Return{result}\;

